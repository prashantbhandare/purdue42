this is modified code
updated from dev1 - defect branch
